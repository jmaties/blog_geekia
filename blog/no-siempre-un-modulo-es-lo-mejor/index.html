<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/geekia_blog/styles.d5ef0abb16ee382cea7f.css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 2.23.12"/><title data-react-helmet="true"></title><link rel="icon" href="/geekia_blog/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="manifest" href="/geekia_blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/geekia_blog/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/geekia_blog/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/geekia_blog/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/geekia_blog/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/geekia_blog/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/geekia_blog/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/geekia_blog/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/geekia_blog/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/geekia_blog/webpack-runtime-5a10220e33c00bcf4dec.js"/><link as="script" rel="preload" href="/geekia_blog/framework-93d3a746c3cf42acdafc.js"/><link as="script" rel="preload" href="/geekia_blog/app-28e9e08f98499be8a322.js"/><link as="script" rel="preload" href="/geekia_blog/styles-89fd2ae28bdf06750a71.js"/><link as="script" rel="preload" href="/geekia_blog/component---src-templates-articulo-js-49e9a97b061fda538afd.js"/><link as="fetch" rel="preload" href="/geekia_blog/page-data/blog/no-siempre-un-modulo-es-lo-mejor/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/geekia_blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header style="background:rebeccapurple;margin-bottom:1.45rem"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem"><h1 style="margin:0"><a style="color:white;text-decoration:none" href="/geekia_blog/">Geekia</a></h1></div></header><div style="margin:0 auto;max-width:960px;padding:0 1.0875rem 1.45rem"><main><div><h1>No siempre un módulo es lo mejor ;)</h1><small><em>Wed Jul 01 2020 01:37:51 GMT+0200 (Central European Summer Time)</em></small><div><p>Hace unos días, preparando un proyecto para un cliente nos surgió un pequeño dilema ¿Usar un módulo específico para un tipo de operación o bien utilizar módulos más comunes como <em> views </em> para hacer algo parecido? La cuestión es que necesitabamos preparar un gestor de publicidad con todo lo que puede utilizar un usuario medio pero sin todas la complejidad de los módulos específicos. En resumen necesitábamos algo&nbsp; <strong> MUY ágil y sencillo </strong> para gestionar&nbsp;"una publicidad" que aparecerá en unos determinados nodos o vistas. Drupal dispone de varios módulos, los cuales probamos para ver si era lo que necesitabamos.</p><p><a href="http://drupal.org/project/ad"> Ad </a> era sin duda la mejor opción, pero es tan "grande" que parecía que estabamos <em> matando moscas a cañonazos. </em> Probamos con <a href="http://drupal.org/project/simpleads"> SimpleAds </a> , también un genial módulo pero al igual que ocurría con el anterior... demasiado grande.</p><p>Así que decidimos hacerlo de una forma "artesanal", usando <a href="http://drupal.org/project/views"> views </a> y un poco de código.</p><p class="imagen_post"><img src="http://farm9.staticflickr.com/8186/8115491731_4389715f82.jpg" alt="Drupal modules" style="width: 500px; height: 442px;" /></p><p>Lo primero que preparamos fue un tipo de contenido <strong> publicidad </strong> con los campos que necesitábamos, no son muchos:</p><ul><li>Título</li><li>Cuerpo de la noticia</li><li>Imagen/banner</li><li>Localización (Taxonomia)</li><li>Tema (que es un campo que comparte con otro tipo de nodo)</li><li>Fecha (Inicio y fin)</li><li>Enlace</li></ul><p>Una vez listo, preparamos una views con 2 <em> contextual filters </em> que son la localización y el tema. El bloque generado por la views sólo se mostrará en un determinado tipo de contenido y para elegir cuál usamos la "maravillosa" API de views3... <strong> hook_views_query_alter(&amp;$view, &amp;$query) </strong> para ello, por ejemplo, para el tema, lo unico que hacemos es buscar el valor de ese campo en el nodo cargado y modificar la query de la views.</p><p>Ej:</p><pre>$id_nodo = arg(1); // Cargamos la id del nodo actual
    $result = db_select('TABLA', 'u') 
      -&gt;fields('u', array('CAMPO'))
      -&gt;condition('entity_id', $id_nodo, '=')
      -&gt;execute() -&gt;fetchAll();
    $tema = $result[0]-&gt;CAMPO_value;
    $query-&gt;where[0]['conditions'][1]['value']= $tema;
</pre><p>De esta forma ya tenemos nuestro mini-gestor de publicidad. Pero necesitábamos tambien contar con estadísticas de clicks. Tiramos de otro módulo que tambien usaba ya el proyecto para generar url cortas:&nbsp; <a href="http://drupal.org/project/shurly"> ShURLy </a> (mola como suena :P). Así, poniendo la url corta en el enlace del nodo <strong> publicidad </strong> podemos tener los "clicks" que se han hecho en anuncio concreto.</p><p>Además de todo esto, preparamos un <em> views </em> de administración para poder "gestionar" de forma directa —y, por tanto más sencilla— la publicidad.</p><p>En este ejemplo hablamos de gestión de espacios publicitarios, pero echándole un poco de imaginación pueden surgir bastantes más utilidades sin necesidad de instalar más módulos</p></div></div></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/no-siempre-un-modulo-es-lo-mejor";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-28e9e08f98499be8a322.js"],"component---src-pages-404-js":["/component---src-pages-404-js-852bd3a5faea7629c57d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-68faecb2d90a381a9939.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-ef8c063115e3c48e159a.js"],"component---src-pages-posts-js":["/component---src-pages-posts-js-2999c78a9b9f2007358e.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-e9054962b603b8d7736f.js"],"component---src-templates-articulo-js":["/component---src-templates-articulo-js-49e9a97b061fda538afd.js"]};/*]]>*/</script><script src="/geekia_blog/component---src-templates-articulo-js-49e9a97b061fda538afd.js" async=""></script><script src="/geekia_blog/styles-89fd2ae28bdf06750a71.js" async=""></script><script src="/geekia_blog/app-28e9e08f98499be8a322.js" async=""></script><script src="/geekia_blog/framework-93d3a746c3cf42acdafc.js" async=""></script><script src="/geekia_blog/webpack-runtime-5a10220e33c00bcf4dec.js" async=""></script></body></html>